FROM diamonds2_base:latest AS base
WORKDIR /app/packages/backend
RUN apt-get update -y && apt-get install -y openssl
COPY --chown=1000:1000 packages/backend .

FROM base AS develop
ENV PORT=3000
EXPOSE $PORT
CMD ["deno", "run", "start:dev"]

FROM base AS prod
ENV PORT=3000
EXPOSE $PORT
CMD ["run", "start:prod"]
